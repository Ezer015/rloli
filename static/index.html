<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Roll LOLI</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;800&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        txt: '#ededed',
                        dim: '#666',
                        acc: '#fff',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'spin-slow': 'spin 2s linear infinite',
                        'dash': 'dash 1.5s ease-in-out infinite',
                        'rotate-once': 'spin 0.6s cubic-bezier(.23, 1, .32, 1)',
                    },
                    keyframes: {
                        dash: {
                            '0%': { strokeDasharray: '1, 150', strokeDashoffset: '0' },
                            '50%': { strokeDasharray: '90, 150', strokeDashoffset: '-35' },
                            '100%': { strokeDasharray: '90, 150', strokeDashoffset: '-124' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .glass {
                @apply bg-[rgba(20,20,20,0.6)] border border-white/10 backdrop-blur-xl;
            }
            .ease-custom {
                transition-timing-function: cubic-bezier(.23, 1, .32, 1);
            }
        }
        body {
            background: radial-gradient(circle at 50% 0, #1a1a1a, #050505 70%);
        }
    </style>

    <!-- Import Map -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="m-0 h-screen overflow-hidden text-txt font-sans">

    <div id="root" class="w-full h-full"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useCallback } from 'react';
        import { createRoot } from 'react-dom/client';
        import {
            LayoutGrid, RectangleHorizontal, RectangleVertical,
            Dice1, Dice2, Dice3, Dice4, Dice5, Dice6
        } from 'lucide-react';

        const Spinner = () => (
            <svg className="absolute w-16 h-16 animate-spin-slow pointer-events-none z-[5]" viewBox="0 0 50 50">
                <circle className="stroke-white/10 fill-none stroke-[3]" cx="25" cy="25" r="20" strokeLinecap="round" />
                <circle className="stroke-acc fill-none stroke-[3] animate-dash" cx="25" cy="25" r="20" strokeLinecap="round" />
            </svg>
        );

        const DICE_ICONS = [Dice1, Dice2, Dice3, Dice4, Dice5, Dice6];

        const App = () => {
            const [mode, setMode] = useState('/');
            const [imgSrc, setImgSrc] = useState('');
            const [loading, setLoading] = useState(true);
            const [diceIndex, setDiceIndex] = useState(0);
            const [isFabRotating, setIsFabRotating] = useState(false);

            const loadNewImage = useCallback((currentMode) => {
                setLoading(true);
                setIsFabRotating(true);
                setDiceIndex(Math.floor(Math.random() * 6));

                const url = `${currentMode === '/' ? '' : currentMode}/?t=${Date.now()}`;
                const tmp = new Image();

                tmp.onload = () => {
                    setImgSrc(url);
                    setTimeout(() => {
                        setLoading(false);
                        setIsFabRotating(false);
                    }, 50);
                };
                tmp.onerror = () => setTimeout(() => loadNewImage(currentMode), 1000);
                tmp.src = url;
            }, []);

            useEffect(() => { loadNewImage(mode); }, []);

            const handleModeChange = (newMode) => {
                if (newMode === mode) return;
                setMode(newMode);
                loadNewImage(newMode);
            };

            const CurrentDiceIcon = DICE_ICONS[diceIndex];

            return (
                <div className="w-full h-full relative flex items-center justify-center">

                    <h1 className="fixed top-6 left-7 m-0 text-2xl font-extrabold -tracking-[0.03em] bg-gradient-to-br from-white to-dim bg-clip-text text-transparent z-[9] pointer-events-none select-none">
                        <span className="sm:hidden">RLOLI</span>
                        <span className="hidden sm:inline">Roll LOLI</span>
                    </h1>

                    <nav className="fixed top-6 left-1/2 -translate-x-1/2 z-10 flex gap-1 p-1 glass rounded-xl transition-all">
                        {[{ m: '/', icon: LayoutGrid }, { m: '/h', icon: RectangleHorizontal }, { m: '/v', icon: RectangleVertical }].map((btn) => {
                            const IconComp = btn.icon;
                            return (
                                <button
                                    key={btn.m}
                                    onClick={() => handleModeChange(btn.m)}
                                    className={`w-11 h-9 border-0 rounded-lg cursor-pointer transition-all duration-300 ease-custom grid place-items-center ${mode === btn.m ? 'bg-white/10 text-acc shadow-[0_0_10px_rgba(0,0,0,0.2)]' : 'bg-transparent text-dim hover:text-txt hover:bg-white/5'
                                        }`}
                                >
                                    <IconComp size={20} strokeWidth={1.5} />
                                </button>
                            );
                        })}
                    </nav>

                    <div className="relative w-full h-full grid place-items-center">
                        {loading && <Spinner />}
                        {imgSrc && (
                            <img
                                src={imgSrc}
                                alt="Random"
                                className={`max-w-[88vw] max-h-[68vh] rounded-xl shadow-[0_30px_60px_-12px_rgba(0,0,0,0.8)] transition-all duration-600 ease-custom object-contain ${loading ? 'opacity-0 scale-95 translate-y-[10px] blur-[20px]' : 'opacity-100 scale-100 translate-y-0 blur-0'}`}
                            />
                        )}
                    </div>

                    <button
                        onClick={() => loadNewImage(mode)}
                        disabled={loading}
                        className="fixed bottom-6 sm:bottom-12 z-20 w-[72px] h-[72px] rounded-3xl glass text-acc cursor-pointer shadow-[0_20px_40px_-10px_rgba(0,0,0,0.5)] transition-all duration-300 ease-custom grid place-items-center hover:bg-white/10 hover:border-white/30 hover:-translate-y-1 hover:shadow-[0_0_20px_rgba(255,255,255,0.05),0_20px_40px_-10px_rgba(0,0,0,0.6)] active:scale-95 disabled:opacity-80 disabled:cursor-not-allowed"
                    >
                        <div className={isFabRotating ? 'animate-rotate-once' : ''}>
                            <CurrentDiceIcon size={32} strokeWidth={1.8} />
                        </div>
                    </button>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>